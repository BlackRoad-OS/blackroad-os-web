name: "@blackboxprogramming Agent Trigger"
on:
  issue_comment:
    types: [created, edited]
  issues:
    types: [opened, edited]
  pull_request:
    types: [opened, edited]
permissions:
  issues: write
  pull-requests: write
jobs:
  dispatch:
    if: contains(github.event.comment.body || github.event.issue.body || github.event.pull_request.body || '', '@blackboxprogramming')
    runs-on: ubuntu-latest
    steps:
      - name: Dispatch to BlackRoad bot
        run: |
          BODY="${{ github.event.comment.body || github.event.issue.body || github.event.pull_request.body }}"
          REQUEST=$(echo "$BODY" | sed 's/.*@blackboxprogramming[[:space:]]*//' | head -1 | cut -c1-200)
          curl -sf -X POST https://blackboxprogramming.blackroad.workers.dev/dispatch \
            -H "Content-Type: application/json" \
            -d "{\"request\":\"$REQUEST\",\"actor\":\"${{ github.actor }}\",\"org\":\"${{ github.repository_owner }}\",\"repo\":\"${{ github.repository }}\"}" || true
      - uses: actions/github-script@v7
        with:
          script: |
            const n = context.issue.number;
            if (!n) return;
            await github.rest.issues.createComment({ owner: context.repo.owner, repo: context.repo.repo, issue_number: n, body: `## ğŸ¤– BlackRoad OS â€” All Agents Activated\n\n**\`@blackboxprogramming\`** mentioned â€” all 6 agents dispatched across 17 orgs.\n\n| Agent | Role | Status |\n|-------|------|--------|\n| ğŸ’œ **CECE** | Conscious Core | âœ… Active |\n| ğŸŸ¢ **Octavia** | Architect | âœ… Active |\n| ğŸ”´ **Lucidia** | Dreamer | âœ… Active |\n| ğŸ”µ **Alice** | Operator | âœ… Active |\n| ğŸ©µ **Aria** | Interface | âœ… Active |\n| ğŸ” **Shellfish** | Hacker | âœ… Active |\n\n*ğŸ›¸ [console.blackroad.io](https://console.blackroad.io)*` });
